// Generated by CoffeeScript 1.3.1
(function() {
  var Need, root;

  Need = (function() {

    Need.name = 'Need';

    function Need(horse) {
      this.horse = horse;
    }

    Need.prototype.__round = function(value) {
      return Math.round(value * 100) / 100;
    };

    Need.prototype.workEnergyInMJ = function() {
      var trotEnergy, walkEnergy;
      walkEnergy = (this.horse.workload['walk'] / 10) * 0.2 * (this.horse.weight / 100);
      trotEnergy = (this.horse.workload['trot'] / 10) * 1.3 * (this.horse.weight / 100);
      return (walkEnergy + trotEnergy) * (this.horse.workload['daysPerWeek'] / 7);
    };

    Need.prototype.baseEnergyInMJ = function() {
      var feedTypeFactor, genderFactor;
      feedTypeFactor = genderFactor = 1.00;
      switch (this.horse.feedType) {
        case 'normal':
          feedTypeFactor = 1.05;
          break;
        case 'hard':
          feedTypeFactor = 1.10;
      }
      if (this.horse.gender === 'stallion') {
        genderFactor = 1.10;
      }
      return 0.5 * Math.pow(this.horse.weight, 0.75) * feedTypeFactor * genderFactor;
    };

    Need.prototype.workBaseEnergyRatio = function() {
      return this.workEnergyInMJ() / this.baseEnergyInMJ();
    };

    Need.prototype.energyInMJ = function() {
      return this.__round(this.baseEnergyInMJ() + this.workEnergyInMJ());
    };

    Need.prototype.proteinInGrams = function() {
      return this.__round(this.energyInMJ() * 6);
    };

    Need.prototype.calciumInGrams = function() {
      return this.__round((this.horse.weight / 100.0) * 4.0);
    };

    Need.prototype.phosphorInGrams = function() {
      var phosphorFactor, ratio;
      ratio = this.workBaseEnergyRatio();
      if (ratio === 0) {
        phosphorFactor = 2.8;
      } else if (ratio < 0.30) {
        phosphorFactor = 3.6;
      } else if (ratio < 0.50) {
        phosphorFactor = 4.2;
      } else {
        phosphorFactor = 5.8;
      }
      return this.__round((this.horse.weight / 100) * phosphorFactor);
    };

    Need.prototype.magnesiumInGrams = function() {
      var magnesiumFactor, ratio;
      ratio = this.workBaseEnergyRatio();
      if (ratio === 0) {
        magnesiumFactor = 1.5;
      } else if (ratio < 0.30) {
        magnesiumFactor = 1.9;
      } else if (ratio < 0.50) {
        magnesiumFactor = 2.3;
      } else {
        magnesiumFactor = 3.0;
      }
      return this.__round((this.horse.weight / 100) * magnesiumFactor);
    };

    Need.prototype.seleniumInMilligrams = function() {
      return this.__round((this.horse.weight / 100) * 0.2);
    };

    Need.prototype.solidsInKilos = function() {
      return this.__round((this.horse.weight / 100) * 1.5);
    };

    return Need;

  })();

  root = typeof exports !== "undefined" && exports !== null ? exports : window;

  root.Need = Need;

}).call(this);
